db_host = "dpg-cv64ms3qf0us73euprig-a"
db_port = 5432
db_name = "readlink_db"
db_user = "readlink_db_user"
db_password = "FKszvR3UF3oDWqq6j6QXBhgnfASqs8DO"
file_path = '/public/libraries across Japan.csv' # CSVファイルの絶対パスまたはRailsアプリ内の相対パス

sql_command = <<-SQL
  COPY libraries FROM '#{file_path}' WITH (FORMAT CSV, HEADER);
SQL

command = "psql -h #{db_host} -p #{db_port} -d #{db_name} -U #{db_user} -w -c \"#{sql_command}\""

puts "Executing command: #{command}" # 実行するコマンドを表示（デバッグ用）

result = `PGPASSWORD="#{db_password}" #{command}`

puts result # 結果を表示



sql_command = "GRANT pg_read_server_files TO readlink_db_user;"
command = "psql -h #{db_host} -p #{db_port} -d #{db_name} -U postgres -w -c \"#{sql_command}\"" # postgresユーザーで実行
result = `PGPASSWORD="#{db_password}" #{command}`
puts result